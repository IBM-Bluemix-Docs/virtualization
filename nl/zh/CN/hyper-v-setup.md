---



copyright:
  years: 2014, 2018
lastupdated: "2018-08-16"

subcollection: virtualization


---

{:shortdesc: .shortdesc}
{:codeblock: .codeblock}
{:screen: .screen}
{:new_window: target="_blank"}
{:pre: .pre}
{:tip: .tip}
{:table: .aria-labeledby="caption"}

# 设置 Hyper-V
{: #setting-up-hyper-v}

设置 Hyper-V 的过程包括 Hyper-V 的初始配置、虚拟机创建以及在新虚拟机上进行网络配置。以下准则说明了这些过程。

## 使用 Hyper-V 管理器
{: #using-hyper-v-manager}

Hyper-V 管理器是用于操作 Hyper-V 的管理控制台。通过 Hyper-V 管理器，可以创建、启动、停止、删除和配置所有虚拟机。在该管理控制台中，还可设置用于存储虚拟硬盘的缺省位置以及用于存储虚拟机配置文件的缺省位置。

可以在 Windows 控制面板的**管理工具**下找到 Hyper-V 管理器。在 Windows 2008 的新安装上，可以在“开始”菜单的“程序”下找到**管理工具**。打开 Hyper-V 管理器程序后，屏幕上将显示一个新窗口。请花一些时间来熟悉此屏幕。虚拟机的所有配置和使用都在此处完成。

## 配置 Hyper-V
{: #configuring-hyper-v}

要检查的第一个配置是虚拟硬盘的存储位置。在 Hyper-V 管理器窗口左侧，可以看到 **Hyper-V 管理器**和服务器名称。单击服务器名称，然后可以看到服务器上可用于 Hyper-V 服务的信息。现在，屏幕中间为空白，因为显示未安装任何虚拟机。在屏幕右侧，可看到 **Hyper-V 设置**的链接。 单击该链接可启动 Hyper-V 的基本设置。

您需要查看的主要设置是**虚拟硬盘**。在右侧，您会看到存储虚拟硬盘的缺省位置。缺省位置为：

`C:\Users\Public\Documents\Hyper-V\Virtual Hard Disks`

创建虚拟机时，如果不希望将该特定虚拟硬盘存储在缺省位置，那么可以指定特定位置。例如，要将虚拟硬盘存储在另一个更大的驱动器（此示例中为 D 盘）上，并且希望这些虚拟驱动器存储在 **VirtualMachine** 文件夹中，请在该字段中输入 `D:\VirtualMachine`。

****

还可以手动浏览文件夹以选择要使用的位置。选择位置后，单击**确定**。

## 配置网络设备
{: #configuring-network-devices}

配置虚拟网络设备之前，请确定哪些网络适配器连接到专用和公用网络。在“开始”菜单中，单击**网络连接**。在此将看到两个网络设备。确保您看到的设备名为 **PrivateNetwork** 和 **PublicNetwork**。右键单击 **PrivateNetwork**，并选择**属性**。您将看到**连接使用：**，其中显示专用网络适配器的设备名。记下此名称，因为创建虚拟专用网络设备时需要此名称。

### 配置专用网络设备
{: #configuring-a-private-network-device}

既然已配置了存储虚拟硬盘的缺省位置，那就需要配置虚拟机使用的虚拟网络设备。要打开虚拟网络管理器，请单击 Hyper-V 管理器窗口右侧标注的**虚拟网络管理器**。

第一次打开此窗口时，您将看到左侧的“虚拟网络”中唯一列出的选项是**新建虚拟网络**。在右侧，有三个选项：
* 外部
* 内部
* 专用。
确保选择**外部**，然后单击**添加**。

继续在其余字段中输入信息：
* **名称**：与此网络设备关联的名称。例如，对于此示例，使用_专用_来指示此设备连接到 IBM Cloud 专用网络。
* **连接类型**：选择对应于专用网络的设备。此名称是先前在**网络连接**窗口中找到的设备名。选择正确的设备后，单击**确定**。这将显示一个警告，指示网络连接可能丢失，请单击**是**以继续。

### 配置公用网络设备
{: #configuring-a-public-network-device}

现在专用网络设备已安装。请对公用网络重复上述步骤。对于此示例，请将名称**公用**用作设备名。在“连接类型”下，选择专用网络设置中未使用的其他网络设备。创建公用和专用网络设备后，单击**确定**。

## 获取安装介质
{: #obtaining-installation-media}

既然虚拟网络设备已创建，那就需要获取安装介质。此示例中使用的安装介质是 CD/DVD 映像文件。IBM Cloud 支持以下操作系统用于 Hyper-V：
* Windows 2008
* Windows 2003
* CentOS
* Fedora
* Ubuntu。
**注：**如果您已有安装介质，请转至**创建虚拟机**。

[CentOS ![外部链接图标](../../icons/launch-glyph.svg "外部链接图标")](http://centos.org){: new_window}、[Fedora ![外部链接图标](../../icons/launch-glyph.svg "外部链接图标")](http://fedoraproject.org/){: new_window} 和 [Ubuntu ![外部链接图标](../../icons/launch-glyph.svg "外部链接图标")](http://www.ubuntu.com/){: new_window} 的安装介质可从其各自的 Web 站点获取。所有这三个操作系统都是免费许可的，无需用户方面执行任何进一步操作。

## 创建虚拟机
{: #creating-a-virtual-machine}

既然您已具有安装介质，那就可以在 Hyper-V 管理器中创建虚拟机。单击**新建 > 虚拟机**以启动**新建虚拟机向导**。

在第一个屏幕上，单击**下一步**，然后输入新虚拟机的名称。此名称可在未来进行更改。可以更改虚拟硬盘的位置。除非指定其他位置，否则将使用先前设置的缺省值。输入信息后，单击**下一步**。

现在，需要为服务器分配内存。通常，至少提供操作系统指定的最小建议内存。输入要分配的内存量后，单击**下一步**。

接下来，设置第一个网络适配器。如果虚拟机上安装的是 Linux 操作系统，请选择**未连接**。如果安装的是 Windows，请选择**专用**，然后单击**下一步**。

可以更改虚拟盘的以下设置：文件名、存储位置和大小。进行任何适用的更改，然后单击**下一步**。

安装介质需要进行设置。选择**从引导 CD/DVD-ROM 安装操作系统 > 映像文件 (.iso)**，以设置安装介质的 CD/DVD 映像文件的位置。单击**下一步**，查看摘要并单击**完成**以关闭窗口。

最后，需要创建虚拟网络适配器。现在，新的虚拟机已列在 Hyper-V 管理器的**虚拟机**部分下。右键单击新的虚拟机，并单击**设置**。

### 针对 Windows 操作系统配置虚拟网络适配器
{: #configuring-virtual-network-adapter-for-windows-operating-system}

现在，虚拟机的硬件列表可用。在列表中，您将看到**网络适配器**和**专用**。如果看到的是**未连接**，请单击“网络适配器”，选择**专用**，然后单击**应用**。

接下来，单击**添加硬件 > 网络适配器 > 添加**，以将该网络适配器添加到硬件。

在右窗格上，从下拉列表中选择**公共**，然后单击**确定**。

### 针对 Linux 操作系统配置虚拟网络适配器
{: #configuring-virtual-network-adapter-for-linux-operating-system}

现在，虚拟机的硬件列表可用。单击**网络适配器 > 除去**，然后选择**添加硬件**。右侧的列表将发生变化。从该列表中，选择**原有网络适配器**。**注：**此选项与不在 Linux 虚拟机上使用的网络适配器不同。单击**添加**以将此原有网络适配器添加到硬件列表。这将自动选择新的原有网络适配器。从下拉列表中选择**专用**，然后单击**应用**。重复上述步骤以添加**原有网络适配器**。但是，这次选择**公共**。添加新的原有网络适配器后，单击**确定**。

## 安装访客操作系统
{: #installing-a-guest-operating-system}

现在，虚拟机已准备好启动。右键单击该虚拟机，并选择**连接**。这将打开虚拟机控制台。从**操作**菜单中，选择**启动**。新的虚拟机将使用您选择的安装介质启动。现在，可以运行整个操作系统安装。在操作系统安装过程中，建议配置公用网络设置。公用网络是第二个网络接口。操作系统安装完成后，您即有了有效虚拟机。如果配置了公用网络，那么可以远程访问该虚拟机。

安装过程中的最后一步是配置专用网络。如果虚拟机不连接到专用网络，那么安装过程完成。有关配置专用网络的更多信息，请参阅[设置虚拟机网络](/docs/infrastructure/virtualization?topic=Virtualization-setting-up-a-virtual-machine-network)。
